# Python Malware Analyzer

Projet Python d'analyse de malware via l'API Virus Total. Ce projet à pour but de pouvoir analyser à la volé des fichiers suspicieux via l'api Virus Total et de générer un rapport détaillé 

## Architecture du script



![schema_virustotal](https://github.com/user-attachments/assets/0caa4a8d-2b24-4ae4-a6fa-958bbf449ecb)



### Composition du projet

- **Main.py :** script python principale
- **Template.md :** fichier de template du rapport Virus Total
- **Malware.exe :** exécutable malveillant de test ( !! ne pas exécuter sur sa machine)
- **Requirements.txt :** fichier texte contenant toutes les dépendances python nécessaire au lancement du script

### Fonctionnement du script

- **Import des librairies :**

![image](https://github.com/user-attachments/assets/2579025f-b128-422d-b082-5e5bc54b65bd)

- **Configuration des variables Virus Total :**

![image](https://github.com/user-attachments/assets/fdb854a3-b330-4724-9d97-19043bc70b0b)

- **Récupération de la template :**

![image](https://github.com/user-attachments/assets/5c6bb5d2-cd49-430a-ad3a-e1398ae0bc5e)

- **Soumission du fichier à Virus Total :**

![image](https://github.com/user-attachments/assets/a95d0777-ea59-4ac8-9391-a5c4fb829ae5)

1 . Soumission du fichier à Virus Total pour analyse
2 . Vérification du succès de la soumission
3 . Si soumission OK retour d'un ID unique pour le fichier
4 . Si erreur, affichage d'un message d'erreur

- **Récupération du rapport Virus Total :**

![image](https://github.com/user-attachments/assets/e05d739b-215d-4020-88da-5ef77648ba30)

1 . Envoi d'une requête à Virus Total pour récupérer le rapport d'anayle lié à l'id de notre fichier
2 . Vérification de la réponse avec le code 200 (OK en HTTP)
3 . Si OK retour du rapport en JSON
4 . Si erreur affichage de l'erreur

- **Génération d'un rapport via notre template personalisée :**

![image](https://github.com/user-attachments/assets/6e44f13a-19ff-4f47-b779-c85c08314fb2)

1 . Lecture de notre template personalisée
2 . Extraction des infos pertinentes des résultats de l'analyse
3 . Mise en forme de la template avec les informations
4 . Export du rapport final dans un fichier markdown
5 . Affiche un message de succès de la génération du rapport

- **Choix supression fichier malveillant :**

![image](https://github.com/user-attachments/assets/b43a6308-ef0a-450b-8360-a31d49a250c3)

1 . Demande à l'utilisateur s'il veux supprimer le fichier
2 . Si oui supression avec os.remove
3 . Si la supression échoue affiche l'erreur
4 . Si non aucune action sur le fichier

- **Fonction principale pour soumettre et analyser le fichier avec Virus Total

![image](https://github.com/user-attachments/assets/7093196d-46c6-4f7b-9868-03746d86fb06)

1 . Soumission du fichier à Virus Total
2 . Affiche la barre de progression de l'analyse
3 . Récupère les résultats
4 . Génération du rapport
5 . Affichage d'un message si malware détecté ou non
6 . Si malware propose la supression



### Prérequis

- **Python :** Ce projet n'ésésite la présence de python sur le système
- **Malware :** Afin de pouvoir correctement tester l'exécution du script un fichier malveillants est nécessaire, si besoin un fichier malware.exe est disponible au sein du projet

### Installation

- **Copier le projet :** git clone https://github.com/NoaMatout/Malware_Analyzer.git

- **Rentrer dans le répertoire :** cd Malware_Analyzer/

- **Modifier les variables :** Changer la valeur de la clé API dans le main.py : API_KEY = 'CHANGE ME'

- **Installation des librairies Python :** pip install -r requirements.txt

- **Installation de Tkinter :** *Linux* : sudo apt-get install python3-tk
    *Windows* : python -m tkinter


- **Supprimer le malware.exe :** rm malware.exe



## Lancement

Mettre vidéo de démonstration

## Future Additions

We're continuously expanding this repository with new examples. Stay tuned for more scripts that cover different facets of the VirusTotal API. Each addition will be accompanied by a comprehensive article on [StackZero](https://www.stackzero.net/) to explain the code and its application in depth.

## Feedback and Questions

For any feedback, questions, or clarifications regarding the scripts or the associated articles, please refer to the [StackZero website](https://www.stackzero.net/).

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.

---

Remember to always stay updated with the latest cybersecurity trends and best practices. Follow [StackZero](https://www.stackzero.net/) for more insightful articles and practical guides. If you find these scripts useful, don't forget to start this repository and share it with your peers!
---

Remember to always stay updated with the latest cybersecurity trends and best practices. Follow [StackZero](https://www.stackzero.net/) for more insightful articles and practical guides. If you find these scripts useful, don't forget to start this repository and share it with your peers!
